<!-- Mermaid Support -->
<script src="https://cdn.jsdelivr.net/npm/mermaid@10.6.0/dist/mermaid.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    mermaid.initialize({
      startOnLoad: true,
      theme: 'default',
      securityLevel: 'loose',
      flowchart: {
        useMaxWidth: true,
        htmlLabels: true,
        curve: 'basis'
      },
      themeVariables: {
        fontFamily: '-apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif',
        fontSize: '14px'
      }
    });
    
    // Process mermaid code blocks
    const mermaidElements = document.querySelectorAll('code.language-mermaid');
    mermaidElements.forEach(function(element, index) {
      const graphDefinition = element.textContent;
      const graphId = 'mermaid-graph-' + index;
      
      // Create a new div for the mermaid graph
      const mermaidDiv = document.createElement('div');
      mermaidDiv.className = 'mermaid';
      mermaidDiv.id = graphId;
      mermaidDiv.textContent = graphDefinition;
      
      // Replace the code block with the mermaid div
      element.parentNode.parentNode.replaceChild(mermaidDiv, element.parentNode);
    });
    
    // Re-initialize mermaid for the new elements
    mermaid.init();
  });
</script>

<!-- Custom styles for mermaid -->
<style>
  .mermaid {
    text-align: center;
    background: white;
    border: 1px solid #e1e4e8;
    border-radius: 6px;
    padding: 16px;
    margin: 16px 0;
    overflow-x: auto;
  }
  
  /* Improve Chinese font in mermaid diagrams */
  .mermaid text {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", "PingFang SC", "Hiragino Sans GB", "Microsoft YaHei", "Helvetica Neue", Helvetica, Arial, sans-serif !important;
    font-size: 12px !important;
  }
  
  /* Better styling for mermaid elements */
  .mermaid .node rect,
  .mermaid .node circle,
  .mermaid .node ellipse,
  .mermaid .node polygon {
    stroke-width: 2px;
  }
  
  .mermaid .edgePath .path {
    stroke-width: 2px;
  }
  
  /* Responsive design for mermaid diagrams */
  @media (max-width: 768px) {
    .mermaid {
      font-size: 10px;
      padding: 8px;
    }
    
    .mermaid text {
      font-size: 10px !important;
    }
  }
</style> 